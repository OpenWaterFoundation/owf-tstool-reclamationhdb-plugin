# DateValueTS 1.6 file
# File generated by...
# program:      TSTool 14.0.2 (2021-11-15)
# user:         sam
# date:         Wed Nov 24 16:31:21 America/Denver 2021
# host:         RoaringFork
# directory:    C:\Users\sam\cdss-dev\TSTool\git-repos\cdss-app-tstool-test\test\commands\WriteReclamationHDB
# command line: TSTool
#  -home test/operational/CDSS
# -----------------------------------------------------------------------
# Command file name: "C:\Users\sam\cdss-dev\TSTool\git-repos\cdss-app-tstool-test\test\commands\WriteReclamationHDB\Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble.TSTool"
# Commands: 
# # Test writing a Month ensemble of model time series to ReclamationHDB database:
# # - development database
# # - old WRITE_TO_HDB procedure
# # - model table since ensemble
# # - fabricated ensemble data
# # - Month interval
# # - SDI 100376 AAB_DELETE (average flow)
# # - pick a short period
# # - Write twice with different numbers to make sure old results are not just sitting
# #   in the database.  Write non-missing values because HDB convention is to
# #   NOT write missing values (not sure how re-write is handled if missing involved).
# # - Use ReadReclamationHDB() and WriteRlamationHDB() because ensembles don't work with TSIDs
# #@testSuite ReclamationHDB
# StartLog(LogFile="Results/Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble.TSTool.log")
# RemoveFile(InputFile="Results/Test_ReclamationHDB_Dev_Month_AAADELETE_Ensemble.dv",IfNotFound=Ignore)
# #
# #------------------------- start the first pass -------------------------------------
# SetInputPeriod(InputStart="2010-01",InputEnd="2010-10")
# SetOutputPeriod(OutputStart="2010-01",OutputEnd="2010-10")
# SetProperty(PropertyName="InputEnd2",PropertyType=DateTime,PropertyValue="2010-11")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS1",NewTSID="AAA_DELETE.HDB.flow.Month[2010]",Description="AAA_DELETE",Units="cfs",PatternValues="6.5,11.5,13.5,14.5,76.5,34.5,15.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS2",NewTSID="AAA_DELETE.HDB.flow.Month[2011]",Description="AAA_DELETE",Units="cfs",PatternValues="7.5,12.5,14.5,15.5,77.5,35.5,16.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS3",NewTSID="AAA_DELETE.HDB.flow.Month[2012]",Description="AAA_DELETE",Units="cfs",PatternValues="8.5,13.5,15.5,16.5,78.5,34.5,17.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS4",NewTSID="AAA_DELETE.HDB.flow.Month[2013]",Description="AAA_DELETE",Units="cfs",PatternValues="4.5,14.5,16.5,17.5,79.5,37.5,18.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS5",NewTSID="AAA_DELETE.HDB.flow.Month[2014]",Description="AAA_DELETE",Units="cfs",PatternValues="10.5,15.5,17.5,18.5,80.5,38.5,19.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TS6",NewTSID="AAA_DELETE.HDB.flow.Month[2015]",Description="AAA_DELETE",Units="cfs",PatternValues="11.5,16.5,18.5,19.5,81.5,39.5,20.5")
# NewEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS1",NewEnsembleID="AAA_DELETE",NewEnsembleName="AAA_DELETE")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS2",EnsembleID2="AAA_DELETE")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS3",EnsembleID2="AAA_DELETE")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS4",EnsembleID2="AAA_DELETE")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS5",EnsembleID2="AAA_DELETE")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TS6",EnsembleID2="AAA_DELETE")
# WriteReclamationHDB(DataStore="hdbtest",TSList=EnsembleID,EnsembleID="AAA_DELETE",SiteDataTypeID=100376,NewEnsembleName="AAA_DELETE Month Date",EnsembleTrace="%z",EnsembleModelName="NWS CBRFC Forecast",NewEnsembleModelRunDate="2013-10-02 10:11",ValidationFlag="P",TimeZone="MST",WriteProcedure="OLD_WRITE_TO_HDB",EnsembleIDProperty="HDBEnsembleIDFromWrite")
# # Now read the same time series from the database using the period that was written...
# ReadReclamationHDB(DataStore="hdbtest",Interval="Month",SiteDataTypeID=100376,EnsembleName="AAA_DELETE Month Date",OutputEnsembleID="FirstRead",Alias="AAA_DELETE-Month-%z")
# # Compare the time series read as a time series with a time series created from SQL query output.
# # - The site_datatype_id is a double in HDB rather than an int so have to format it as an integer
# ReadTableFromDataStore(DataStore="hdbtest",Sql="select * from M_MONTH, HDB_MODEL, REF_MODEL_RUN, REF_ENSEMBLE_TRACE, REF_ENSEMBLE where m_month.model_run_id = ref_model_run.model_run_id and ref_model_run.model_id = hdb_model.model_id and ref_model_run.model_run_id = ref_ensemble_trace.model_run_id and ref_ensemble_trace.ensemble_id = ref_ensemble.ensemble_id and m_month.site_datatype_id = 100376 and ref_ensemble.ensemble_id = ${HDBEnsembleIDFromWrite} and start_date_time >= to_date('${InputStart}-01','YYYY-MM-DD') and start_date_time <= to_date('${InputEnd}-01','YYYY-MM-DD') order by site_datatype_id, hydrologic_indicator, start_date_time",TableID="m_month1")
# FormatTableString(TableID="m_month1",InputColumns="site_datatype_id",Format="%.0f",OutputColumn="site_datatype_id_int",InsertBeforeColumn="start_date_time")
# TableToTimeSeries(TableID="m_month1",DateTimeColumn="start_date_time",LocationColumn="site_datatype_id_int",SequenceIDColumn="hydrologic_indicator",ValueColumn="value",Interval=Month,Units="cfs",Alias="%L-%z-TableFirstRead")
# NewEnsemble(TSList=AllMatchingTSID,TSID="*TableFirstRead",NewEnsembleID="FirstReadFromTable",NewEnsembleName="FirstReadFromTable")
# CompareTimeSeries(EnsembleID1="AAA_DELETE",EnsembleID2="FirstRead",IfDifferent=Warn)
# CompareTimeSeries(EnsembleID1="AAA_DELETE",EnsembleID2="FirstReadFromTable",IfDifferent=Warn)
# # Also check for missing because there should be none over time zone change
# CheckTimeSeries(TSList=EnsembleID,EnsembleID="FirstRead",CheckCriteria="Missing")
# CheckTimeSeries(TSList=EnsembleID,EnsembleID="FirstReadFromTable",CheckCriteria="Missing")
# #
# #------------------------- start the second pass -------------------------------------
# # Start second pass (previous values x 10)...
# NewPatternTimeSeries(Alias="AAA_DELETE_TSa",NewTSID="AAA_DELETE.HDB.flow.Month[2010]",Description="AAA_DELETE",Units="cfs",PatternValues="50.5,100.5,120.5,130.5,750.5,330.5,140.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TSb",NewTSID="AAA_DELETE.HDB.flow.Month[2011]",Description="AAA_DELETE",Units="cfs",PatternValues="51.5,101.5,121.5,131.5,751.5,331.5,141.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TSc",NewTSID="AAA_DELETE.HDB.flow.Month[2012]",Description="AAA_DELETE",Units="cfs",PatternValues="52.5,102.5,122.5,132.5,752.5,332.5,142.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TSd",NewTSID="AAA_DELETE.HDB.flow.Month[2013]",Description="AAA_DELETE",Units="cfs",PatternValues="53.5,103.5,123.5,133.5,753.5,333.5,143.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TSe",NewTSID="AAA_DELETE.HDB.flow.Month[2014]",Description="AAA_DELETE",Units="cfs",PatternValues="54.5,104.5,124.5,134.5,754.5,334.5,144.5")
# NewPatternTimeSeries(Alias="AAA_DELETE_TSf",NewTSID="AAA_DELETE.HDB.flow.Month[2015]",Description="AAA_DELETE",Units="cfs",PatternValues="55.5,105.5,125.5,135.5,755.5,335.5,145.5")
# NewEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSa",NewEnsembleID="AAA_DELETE2",NewEnsembleName="AAA_DELETE2")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSb",EnsembleID2="AAA_DELETE2")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSc",EnsembleID2="AAA_DELETE2")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSd",EnsembleID2="AAA_DELETE2")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSe",EnsembleID2="AAA_DELETE2")
# InsertTimeSeriesIntoEnsemble(TSList=AllMatchingTSID,TSID="AAA_DELETE_TSf",EnsembleID2="AAA_DELETE2")
# # First write the time series to the database...
# WriteReclamationHDB(DataStore="hdbtest",TSList=EnsembleID,EnsembleID="AAA_DELETE2",SiteDataTypeID=100376,NewEnsembleName="AAA_DELETE Month Date",EnsembleTrace="%z",EnsembleModelName="NWS CBRFC Forecast",NewEnsembleModelRunDate="2013-10-02 10:11",ValidationFlag="P",TimeZone="MST",WriteProcedure="OLD_WRITE_TO_HDB",EnsembleIDProperty="HDBEnsembleIDFromWrite")
# # Now read the same time series from the database using the period that was written...
# ReadReclamationHDB(DataStore="hdbtest",Interval="Month",SiteDataTypeID=100376,EnsembleName="AAA_DELETE Month Date",OutputEnsembleID="SecondRead",Alias="AAA_DELETE-Month-%z")
# # Compare the time series read as a time series with a time series created from SQL query output.
# # - The site_datatype_id is a double in HDB rather than an int so have to format it as an integer
# ReadTableFromDataStore(DataStore="hdbtest",Sql="select * from M_MONTH, HDB_MODEL, REF_MODEL_RUN, REF_ENSEMBLE_TRACE, REF_ENSEMBLE where m_month.model_run_id = ref_model_run.model_run_id and ref_model_run.model_id = hdb_model.model_id and ref_model_run.model_run_id = ref_ensemble_trace.model_run_id and ref_ensemble_trace.ensemble_id = ref_ensemble.ensemble_id and m_month.site_datatype_id = 100376 and ref_ensemble.ensemble_id = ${HDBEnsembleIDFromWrite} and start_date_time >= to_date('${InputStart}-01','YYYY-MM-DD') and start_date_time <= to_date('${InputEnd}-01','YYYY-MM-DD') order by site_datatype_id, hydrologic_indicator, start_date_time",TableID="m_month2")
# FormatTableString(TableID="m_month2",InputColumns="site_datatype_id",Format="%.0f",OutputColumn="site_datatype_id_int",InsertBeforeColumn="start_date_time")
# TableToTimeSeries(TableID="m_month2",DateTimeColumn="start_date_time",LocationColumn="site_datatype_id_int",SequenceIDColumn="hydrologic_indicator",ValueColumn="value",Interval=Month,Units="cfs",Alias="%L-%z-TableSecondRead")
# NewEnsemble(TSList=AllMatchingTSID,TSID="*TableSecondRead",NewEnsembleID="SecondReadFromTable",NewEnsembleName="SecondReadFromTable")
# CompareTimeSeries(EnsembleID1="AAA_DELETE2",EnsembleID2="SecondRead",IfDifferent=Warn)
# CompareTimeSeries(EnsembleID1="AAA_DELETE2",EnsembleID2="SecondReadFromTable",IfDifferent=Warn)
# # Also check for missing because there should be none over time zone change
# CheckTimeSeries(TSList=EnsembleID,EnsembleID="SecondRead",CheckCriteria="Missing")
# CheckTimeSeries(TSList=EnsembleID,EnsembleID="SecondReadFromTable",CheckCriteria="Missing")
# #------------------------- end the second pass -------------------------------------
# #
# # Uncomment the following command to regenerate the expected results file.
# WriteDateValue(TSList=EnsembleID,EnsembleID="FirstRead",OutputFile="ExpectedResults/Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble_out.dv")
# # Generate new output for what was read from the database...
# WriteDateValue(TSList=EnsembleID,EnsembleID="FirstRead",OutputFile="Results/Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble_out.dv")
# # Do regression comparison...
# CompareFiles(InputFile1="ExpectedResults\Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble_out.dv",InputFile2="Results/Test_WriteReclamationHDB_Dev_Month_AAADELETE_Ensemble_out.dv",IfDifferent=Warn)
# 
# -----------------------------------------------------------------------------
# HydroBase database is: HydroBase_CO_20200720 on localhost\CDSS
# HydroBase.db_version:  design version: 20200720  last data change: 20200125
# HydroBase table structure for software is at least 2020072020200720
# HydroBase input name is "".
# Stored procedures are being used.
# -----------------------------------------------------------------------------
# 
# 
# -----------------------------------------------------------------------------
# HydroBase database is: HydroBase_CO_20200125 on localhost\CDSS
# HydroBase.db_version:  design version: 20191226  last data change: 20200125
# HydroBase table structure for software is at least 2013040420130404
# HydroBase input name is "".
# Stored procedures are being used.
# -----------------------------------------------------------------------------
# 
# 
# -----------------------------------------------------------------------------
# HydroBase database is: HydroBase_CO_20200720 on localhost\CDSS
# HydroBase.db_version:  design version: 20200720  last data change: 20200125
# HydroBase table structure for software is at least 2020072020200720
# HydroBase input name is "".
# Stored procedures are being used.
# -----------------------------------------------------------------------------
# 
# 
# -----------------------------------------------------------------------------
# HydroBase database is: HydroBase_CO_20180529 on localhost\CDSS
# HydroBase.db_version:  design version: 20161025  last data change: 20180529
# HydroBase table structure for software is at least 2013040420130404
# HydroBase input name is "".
# Stored procedures are being used.
# -----------------------------------------------------------------------------
# 
# 
# -----------------------------------------------------------------------------
# HydroBase database is: HydroBase_CO_20210322 on localhost\CDSS
# HydroBase.db_version:  design version: 20200720  last data change: 20210322
# HydroBase table structure for software is at least 2020072020200720
# HydroBase input name is "".
# Stored procedures are being used.
# -----------------------------------------------------------------------------
# 
#
Delimiter   = " "
NumTS       = 6
TSID        = "diversion:100376-66900.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2010-2010-2013-10-02 10:11[2010]" "diversion:100376-66901.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2011-2011-2013-10-02 10:11[2011]" "diversion:100376-66902.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2012-2012-2013-10-02 10:11[2012]" "diversion:100376-66903.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2013-2013-2013-10-02 10:11[2013]" "diversion:100376-66904.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2014-2014-2013-10-02 10:11[2014]" "diversion:100376-66905.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2015-2015-2013-10-02 10:11[2015]"
Alias       = "AAA_DELETE-Month-2010" "AAA_DELETE-Month-2011" "AAA_DELETE-Month-2012" "AAA_DELETE-Month-2013" "AAA_DELETE-Month-2014" "AAA_DELETE-Month-2015"
SequenceID  = "2010" "2011" "2012" "2013" "2014" "2015"
Description = "100376-66900" "100376-66901" "100376-66902" "100376-66903" "100376-66904" "100376-66905"
DataType    = "flow" "flow" "flow" "flow" "flow" "flow"
Units       = "cfs" "cfs" "cfs" "cfs" "cfs" "cfs"
MissingVal  = NaN NaN NaN NaN NaN NaN
Start       = 2010-01
End         = 2010-10
#
# Time series comments/histories:
#
#
# Creation history for time series 1 (TSID=diversion:100376-66900.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2010-2010-2013-10-02 10:11[2010] Alias=AAA_DELETE-Month-2010):
#
#   Created new time series with interval determined from TSID "diversion:100376-66900.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2010-2010-2013-10-02 10:11"
#
# Creation history for time series 2 (TSID=diversion:100376-66901.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2011-2011-2013-10-02 10:11[2011] Alias=AAA_DELETE-Month-2011):
#
#   Created new time series with interval determined from TSID "diversion:100376-66901.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2011-2011-2013-10-02 10:11"
#
# Creation history for time series 3 (TSID=diversion:100376-66902.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2012-2012-2013-10-02 10:11[2012] Alias=AAA_DELETE-Month-2012):
#
#   Created new time series with interval determined from TSID "diversion:100376-66902.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2012-2012-2013-10-02 10:11"
#
# Creation history for time series 4 (TSID=diversion:100376-66903.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2013-2013-2013-10-02 10:11[2013] Alias=AAA_DELETE-Month-2013):
#
#   Created new time series with interval determined from TSID "diversion:100376-66903.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2013-2013-2013-10-02 10:11"
#
# Creation history for time series 5 (TSID=diversion:100376-66904.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2014-2014-2013-10-02 10:11[2014] Alias=AAA_DELETE-Month-2014):
#
#   Created new time series with interval determined from TSID "diversion:100376-66904.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2014-2014-2013-10-02 10:11"
#
# Creation history for time series 6 (TSID=diversion:100376-66905.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2015-2015-2013-10-02 10:11[2015] Alias=AAA_DELETE-Month-2015):
#
#   Created new time series with interval determined from TSID "diversion:100376-66905.HDB.flow.Month.AAA_DELETE.NWS CBRFC Forecast-AAA_DELETE Month Date2015-2015-2013-10-02 10:11"
#
#EndHeader
Date "AAA_DELETE-Month-2010, cfs" "AAA_DELETE-Month-2011, cfs" "AAA_DELETE-Month-2012, cfs" "AAA_DELETE-Month-2013, cfs" "AAA_DELETE-Month-2014, cfs" "AAA_DELETE-Month-2015, cfs"
2010-01 6.5000 7.5000 8.5000 4.5000 10.5000 11.5000
2010-02 11.5000 12.5000 13.5000 14.5000 15.5000 16.5000
2010-03 13.5000 14.5000 15.5000 16.5000 17.5000 18.5000
2010-04 14.5000 15.5000 16.5000 17.5000 18.5000 19.5000
2010-05 76.5000 77.5000 78.5000 79.5000 80.5000 81.5000
2010-06 34.5000 35.5000 34.5000 37.5000 38.5000 39.5000
2010-07 15.5000 16.5000 17.5000 18.5000 19.5000 20.5000
2010-08 6.5000 7.5000 8.5000 4.5000 10.5000 11.5000
2010-09 11.5000 12.5000 13.5000 14.5000 15.5000 16.5000
2010-10 13.5000 14.5000 15.5000 16.5000 17.5000 18.5000
